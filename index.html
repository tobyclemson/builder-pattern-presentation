<!DOCTYPE html>

<!--
    Google HTML5 slide template

    Authors: Luke MahÃ© (code)
             Marcin Wichary (code and design)

             Dominic Mazzoni (browser compatibility)
             Charles Chen (ChromeVox support)

    URL: http://code.google.com/p/html5slides/
-->

<html>
  <head>
    <title>Test Data Generation using the Builder Pattern</title>
    <meta charset='utf-8'>
    <script src='javascript/slides.js'></script>
    <script src='javascript/prettify.js'></script>
    <link rel="stylesheet" type="text/css" href="stylesheets/overrides.css"/>
  </head>
  <body style='display: none'>

    <section class='slides layout-regular template-default'>

      <article class='front-page'>
        <h1>Test Data Generation <br/>using the Builder Pattern</h1>
        <p>Toby Clemson</p>
      </article>

      <article>
        <h2>What's the problem?</h2>
      </article>

      <article>
        <h3>What's the problem?</h3>
        <ul class='build'>
          <li>
              When a system is <b>simple and contained</b>, instantiating <b>test data</b>
              directly <b>in the test</b> is manageable.
          </li>
          <li>
              As the <b>system grows</b>, the <b>amount of data</b> that has to be
              instantiated <b>grows</b> with it.
          </li>
          <li>
              At some point, <b>abstractions</b> are needed to
              <b>keep test suites maintainable</b>.
          </li>
          <li>
              These abstractions can help form a <b>test language</b>.
          </li>
        </ul>
      </article>

      <article>
        <h3>What's the problem? | Simple Data Setup</h3>
        <pre>goog.require('ck.data.autoscale.Policy');

describe('ck.data.autoscale.Policy', function () {
  it('is editable for scheduled policy', function () {
    var policy;
    policy = new ck.data.autoscale.Policy({ 'type', 'schedule' });
    expect(policy.isEditable()).toBe(true);
  });

  it('is not editable for non-scheduled policy', function () {
    var policy;
    policy = new ck.data.autoscale.Policy({
      'type', 'some-other-type'
    });
    expect(policy.isEditable()).toBe(false);
  });
});</pre>
      </article>

      <article>
        <h3>What's the problem? | Things Get Complex</h3>
        <pre style="font-size: 11px; line-height: 11px;">goog.require('ck.files.files.View');
goog.require('ck.data.files.Files');
goog.require('ck.data.Provider');

describe('ck.files.files.View', function () {
  var storageProviderId, storageProvider, cdnProviderId, cdnProvider,
      containerName, container, files;

  beforeEach(function () {
    setFixtures('&lt;div id="main"&gt;&lt;/div&gt;');

    storageProviderId = 'abc123';
    cdnProviderId = 'cdnp1';

    storageProvider = new ck.data.Provider({
        id: storageProviderId,
        'serviceType': ck.data.Providers.ServiceType.FILES,
        'serviceRegion': ck.data.Provider.Region.DFW,
        'accessAllowed': true
    });
    cdnProvider = new ck.data.Provider({
        id: cdnProviderId,
        'serviceType': ck.data.Providers.ServiceType.FILES_CDN,
        'serviceRegion': ck.data.Provider.Region.DFW,
        'accessAllowed': true
    });
    addTestDependency(storageProvider, ck.data.Providers, providerId);
    addTestDependency(new ck.data.Providers([cdnProvider, storageProvider]), ck.data.Providers);

    containerName = 'Container';
    container = new ck.data.files.Container({
      'id': ck.data.files.Container.getUniqueId(providerId, containerName),
      'name': containerName,
      'count': 15,
      'bytes': 32568
    });
    spyOn(container, 'getProvider').andReturn(storageProvider);
    spyOn(container, 'getCDNProvider').andReturn(cdnProvider);

    files = ck.data.files.Files();

    spyOn(files, 'getModelById');
    spyOn(files, 'setContainer').andCallThrough();
    spyOn(files, 'getContainer').andReturn(container);
  });

  // ...
});</pre>
      </article>

      <article>
        <h3>What's the problem?</h3>
        <ul class='build'>
          <li>
              We've see tests with over <b>100 lines of data setup</b> for <b>a single line of action</b> and <b>a single line of assertion</b>
          </li>
          <li>
              <b>Abstracting</b> away the <b>test data setup</b> may help to <b>get to the point</b> more quickly.
          </li>
          <li>
              At the same time, we need to maintain the <b>intent</b> and <b>flexibility</b> that we have when <b>directly constructing test data</b>.
          </li>
        </ul>
      </article>

      <article>
        <h2>What's the solution?</h2>
      </article>

      <article>
        <h3>What's the solution?</h3>
        <ul class='build'>
          <li>
              <b>Private methods?</b>
          </li>
          <li>
              <b>Better APIs in production code?</b>
          </li>
          <li>
              <b>The Builder pattern?</b>
          </li>
        </ul>
      </article>

      <article>
        <h3>What's the solution? | The Builder Pattern</h3>
        <pre>

        </pre>

      </article>



    </section>

  </body>
</html>
